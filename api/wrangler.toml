name = "web-presence-api"
main = "src/index.ts"
compatibility_date = "2024-09-23"
compatibility_flags = ["nodejs_compat"]
account_id = "61d3245b7e3224d49a9553bdb4d1a70e"

# D1 Database Configuration
[[d1_databases]]
binding = "DB"
database_name = "web-presence-db-local"
database_id = "a298a621-daa5-4001-b2b7-863ff2523a0e"

# R2 Bucket Configuration (Development)
[[r2_buckets]]
binding = "PROTECTED_CONTENT_BUCKET"
bucket_name = "web-presence-dev-protected"
preview_bucket_name = "web-presence-dev-protected"

[[r2_buckets]]
binding = "PUBLIC_CONTENT_BUCKET"
bucket_name = "web-presence-dev-public"
preview_bucket_name = "web-presence-dev-public"

# Environment-specific configurations
[env.development]
name = "web-presence-api-dev"
[[env.development.d1_databases]]
binding = "DB"
database_name = "web-presence-db-local"
database_id = "a298a621-daa5-4001-b2b7-863ff2523a0e"
[[env.development.r2_buckets]]
binding = "PROTECTED_CONTENT_BUCKET"
bucket_name = "web-presence-dev-protected"
[[env.development.r2_buckets]]
binding = "PUBLIC_CONTENT_BUCKET"
bucket_name = "web-presence-dev-public"

[env.production]
name = "web-presence-api"
[[env.production.d1_databases]]
binding = "DB"
database_name = "web-presence-db"
database_id = "22aaa0c4-8060-4417-9649-9cc8cafa7e06"
[[env.production.r2_buckets]]
binding = "PROTECTED_CONTENT_BUCKET"
bucket_name = "protected-content"
[[env.production.r2_buckets]]
binding = "PUBLIC_CONTENT_BUCKET"
bucket_name = "public-content"

# Production environment variables (plain text)
[env.production.vars]
FRONTEND_URL = "https://sawanruparel.com"
CORS_ORIGINS = "https://sawanruparel.com,https://www.sawanruparel.com"
GITHUB_REPO = "sawanruparel/web-presence"
GITHUB_BRANCH = "main"
PROTECTED_CONTENT_BUCKET_NAME = "protected-content"
PUBLIC_CONTENT_BUCKET_NAME = "public-content"

[observability]
enabled = false
head_sampling_rate = 1

[observability.logs]
enabled = true
head_sampling_rate = 1
persist = true
invocation_logs = true

[observability.traces]
enabled = true
persist = true
head_sampling_rate = 1

# Build configuration
# Note: Wrangler handles TypeScript compilation automatically
# No custom build command needed to avoid circular dependencies

# Environment Variables Configuration
# 
# Local Development:
# - Uses .dev.vars file for environment variables
# - Variables: INTERNAL_API_KEY
# 
# Production:
# - Uses Cloudflare Workers secrets
# - Set via: npx wrangler secret put <SECRET_NAME>
# 
# Required Variables:
# - INTERNAL_API_KEY: API key for internal endpoints (build script, admin operations)
# - ADMIN_PASSWORD: Password for admin panel authentication
# 
# Database Configuration:
# - Local: web-presence-db-local (ID: a298a621-daa5-4001-b2b7-863ff2523a0e)
# - Production: web-presence-db (ID: 22aaa0c4-8060-4417-9649-9cc8cafa7e06)
#
# R2 Bucket Configuration:
# - Development: web-presence-dev-protected, web-presence-dev-public
# - Production: protected-content, public-content
